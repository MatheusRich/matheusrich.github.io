<!DOCTYPE html>
<!--[if lt IE 7]><html lang="en" class="no-js lt-ie9 lt-ie8 lt-ie7"><![endif]-->
<!--[if IE 7]><html lang="en" class="no-js lt-ie9 lt-ie8" <![endif]-->
<!--[if IE 8]><html lang="en" class="no-js lt-ie9" <![endif]-->
<!--[if gt IE 8]><!--> <html lang="en" class="no-js"> <!--<![endif]-->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>The Rubygems' web command</title>

    <!-- Open Graph Meta -->
    <meta content="Rich Codes" property="og:site_name">
    
      <meta content="The Rubygems' web command" property="og:title">
    
    
      <meta content="article" property="og:type">
    
    
      <meta content="Hi, I'm Matheus Richard, a Software Engineering from Brazil. I love open source, music, games and creating programming languages." property="og:description">
    
    
      <meta content="http://matheusrich.com/rubygems-web-command/" property="og:url">
    
    
      <meta content="2019-08-21T01:00:00+00:00" property="article:published_time">
      <meta content="http://matheusrich.com/about/" property="article:author">
    
    
      <meta content="http://matheusrich.com/assets/img/code.webp" property="og:image">
    

    <!-- Twitter Cards -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@matheusrich">
    <meta name="twitter:creator" content="@matheusrich">
    
      <meta name="twitter:title" content="The Rubygems' web command">
    
    
      <meta name="twitter:url" content="http://matheusrich.com/rubygems-web-command/">
    
    
      <meta name="twitter:description" content="Hi, I'm Matheus Richard, a Software Engineering from Brazil. I love open source, music, games and creating programming languages.">
    
    
      <meta name="twitter:image:src" content="http://matheusrich.com/assets/img/code.webp">
    

    <meta name="theme-color" content="#111" />

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/assets/img/favicon.ico" />

    <!-- Come and get me RSS readers -->
    <link rel="alternate" type="application/rss+xml" title="Rich Codes" href="http://matheusrich.com/feed.xml" />

    <!-- Stylesheet -->
    <link async rel="stylesheet" href="/assets/css/style.css">
    <!--[if IE 8]><link rel="stylesheet" href="/assets/css/ie.css"><![endif]-->

    <link rel="canonical" href="http://matheusrich.com/rubygems-web-command/">

    <link rel="preconnect" href="https://fonts.googleapis.com/">
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>The Rubygems‚Äô web command | Rich Codes</title>
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="The Rubygems‚Äô web command" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Wow! GSoC is almost on the final evaluation period! Time really flied! I think it‚Äôs a good moment to talk a bit about my work." />
<meta property="og:description" content="Wow! GSoC is almost on the final evaluation period! Time really flied! I think it‚Äôs a good moment to talk a bit about my work." />
<link rel="canonical" href="http://matheusrich.com/rubygems-web-command/" />
<meta property="og:url" content="http://matheusrich.com/rubygems-web-command/" />
<meta property="og:site_name" content="Rich Codes" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-08-21T01:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="The Rubygems‚Äô web command" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2019-08-21T01:00:00+00:00","datePublished":"2019-08-21T01:00:00+00:00","description":"Wow! GSoC is almost on the final evaluation period! Time really flied! I think it‚Äôs a good moment to talk a bit about my work.","headline":"The Rubygems‚Äô web command","mainEntityOfPage":{"@type":"WebPage","@id":"http://matheusrich.com/rubygems-web-command/"},"url":"http://matheusrich.com/rubygems-web-command/"}</script>
<!-- End Jekyll SEO tag -->

</head>


<body>

   <div class="header">
  <div class="container">
    <h1 class="logo">
      <a href="/">
        <span class="dir">~</span>
        <span class="text"> RICH CODES </span>
      </a>
    </h1>
    <nav class="nav-collapse" style="visibility: hidden">
      <ul class="noList">
        
        <li class="element first ">
          <a href="/">üè† Home</a>
        </li>
        
        <li class="element  ">
          <a href="/about/">üë®‚Äçüíª About me</a>
        </li>
        
        <li class="element  ">
          <a href="/categories/">üè∑Ô∏è Categories</a>
        </li>
        
        <li class="element  ">
          <a href="/all/">üìù All posts</a>
        </li>
        
        <li class="element  ">
          <a href="/speaking/">üéôÔ∏è Speaking</a>
        </li>
        
        <li class="element last">
          <button class="theme-toggle" data-theme="dark" onclick="toggleTheme()">Turn lights</button>
        </li>
      </ul>
    </nav>
  </div>
</div>
<!-- end .header -->

<script>
  function toggleTheme() {
    const systemInitiatedDark = window.matchMedia('(prefers-color-scheme: dark)');
    const currentOverridenTheme = sessionStorage.getItem('theme');

    if (currentOverridenTheme === 'dark') {
      document.documentElement.setAttribute('data-theme', 'light');
      sessionStorage.setItem('theme', 'light');
    } else if (currentOverridenTheme === 'light') {
      document.documentElement.setAttribute('data-theme', 'dark');
      sessionStorage.setItem('theme', 'dark');
    } else if (systemInitiatedDark.matches) {
      document.documentElement.setAttribute('data-theme', 'light');
      sessionStorage.setItem('theme', 'light');
    } else {
      document.documentElement.setAttribute('data-theme', 'dark');
      sessionStorage.setItem('theme', 'dark');
    }
  }

  const overridenTheme = sessionStorage.getItem('theme');
  if (overridenTheme === 'dark') {
    document.documentElement.setAttribute('data-theme', 'dark');
    sessionStorage.setItem('theme', 'dark');
  } else if (overridenTheme === 'light') {
    document.documentElement.setAttribute('data-theme', 'light');
    sessionStorage.setItem('theme', 'light');
  }
</script>


   <div class="content">
      <div class="container">
         <article class="post">
  

  <h1 class="postTitle">
    The Rubygems' web command
  </h1>

  <p class="meta">
    August 21, 2019 | <span class="time">3</span> minute read
    

    
      | ‚úçüèº
        <a href="https://github.com/MatheusRich/matheusrich.github.io/blob/main/_posts/2019-08-20-rubygems-web-command.markdown">
          Fix typo
        </a>
    

    
  </p>

  <p>Wow! GSoC is almost on the final evaluation period! Time really flied! I think it‚Äôs a good moment to talk a bit about my work.</p>

<p>As I mentioned in <a href="/me-and-gsoc/">this post</a>, I‚Äôm working with Rubygems for GSoC 2019. <a href="https://github.com/rubygems/rubygems/pull/2835">My Pull Request</a> is still open, but I think it‚Äôs stable enough to write about it (and the process of opening it).</p>

<p>I‚Äôve added a new command to Rubygems: the <code class="language-plaintext highlighter-rouge">web</code> command. Its goal is to help developers to quickly find documentation about a particular gem.</p>

<h2 id="how-does-it-look"><a href="#how-does-it-look">How does it look?</a></h2>

<p>It‚Äôs really simple to use this command. Take a look:</p>

<ul>
  <li><strong>Do you wanna know what is the homepage for some gem?</strong> Just type <code class="language-plaintext highlighter-rouge">gem web gem_name</code> and it will output the URL.</li>
  <li><strong>Quickly access to the rubygems page?</strong> <code class="language-plaintext highlighter-rouge">gem web -r gem_name</code> brings it.</li>
  <li><strong>Can‚Äôt remember what <em>that</em> method does?</strong> <code class="language-plaintext highlighter-rouge">gem web -d gem_name</code> will get the documentation URL for you.</li>
  <li><strong>Want to dive into that good old messy code?</strong> Type <code class="language-plaintext highlighter-rouge">gem web -c gem_name</code> to get its source code.</li>
  <li><strong>I know, we‚Äôre too lazy to copy/paste the link:</strong> Just set the environment variable <code class="language-plaintext highlighter-rouge">BROWSER</code> (e.g. <code class="language-plaintext highlighter-rouge">export BROWSER=google-chrome</code>) and it will automatically open the URL in the browser for you. (Pay <a href="https://github.com/rubygems/rubygems/pull/2835#issuecomment-512542718">Andr√© Arko</a> a beer for this suggestion üòú)</li>
</ul>

<blockquote>
  <p>Some options, like rubytoolbox, were dropped because they make this feature to bound to 3rd party services</p>
</blockquote>

<h2 id="whats-happening-under-the-hood"><a href="#whats-happening-under-the-hood">What‚Äôs happening under the hood?</a></h2>
<p>Adding a new method for Rubygems is not rocket science (I have a post on <a href="/how-rubygems-commands-work/">how to do it</a>). I‚Äôll explain here a bit of how the <code class="language-plaintext highlighter-rouge">web</code> command works (I will be short on some sections to keep this clearer).</p>

<p>The first thing this commands does when it‚Äôs called is to run the method <code class="language-plaintext highlighter-rouge">open_page(gem, options)</code> from <code class="language-plaintext highlighter-rouge">Gem::Web::Executor</code>.</p>

<p>The method will try to find locally a gemspec of the gem you‚Äôve typed with:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">spec</span> <span class="o">=</span> <span class="no">Gem</span><span class="o">::</span><span class="no">Specification</span><span class="p">.</span><span class="nf">find_by_name</span><span class="p">(</span><span class="n">gem</span><span class="p">)</span></code></pre></figure>

<p>The gemspec is important because it has all the info we need (homepage, documentation URI etc).</p>

<blockquote>
  <p>This was one of the differences between the <a href="https://github.com/bitboxer/gem-web">original implementation</a> of <code class="language-plaintext highlighter-rouge">gem-web</code> and mine. It was also a suggestion from the community, for <a href="https://github.com/rubygems/rubygems/pull/2835#issuecomment-512256175">security reasons</a>.</p>
</blockquote>

<p>If the gem is not installed, a <code class="language-plaintext highlighter-rouge">Gem::MissingSpecError</code> will be raised. In this case we have to search on the Rubygems API to find the gemspec.</p>

<p>The method <code class="language-plaintext highlighter-rouge">fetch_remote_spec(gem)</code> is responsible to fetch a remote gemspec (if the gem exists):</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">def</span> <span class="nf">fetch_remote_spec</span><span class="p">(</span><span class="n">gem</span><span class="p">)</span>
  <span class="n">dep</span> <span class="o">=</span> <span class="no">Gem</span><span class="o">::</span><span class="no">Dependency</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">gem</span><span class="p">)</span>
  <span class="n">found</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="no">Gem</span><span class="o">::</span><span class="no">SpecFetcher</span><span class="p">.</span><span class="nf">fetcher</span><span class="p">.</span><span class="nf">spec_for_dependency</span><span class="p">(</span><span class="n">dep</span><span class="p">)</span> <span class="c1"># Here's the request</span>
  <span class="o">...</span>
<span class="k">end</span></code></pre></figure>

<p>If everything went well, we should have the gem specification now (otherwise it will output an error message). Now the command see what options the user selected (homepage, rubygems page, source code or documentation) and calls <code class="language-plaintext highlighter-rouge">open_browser(uri)</code>.</p>

<p>I think the implementation of this method is really simple, take a look:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">def</span> <span class="nf">open_browser</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span>
  <span class="n">browser</span> <span class="o">=</span> <span class="no">ENV</span><span class="p">[</span><span class="s2">"BROWSER"</span><span class="p">]</span>
  <span class="k">if</span> <span class="n">browser</span><span class="p">.</span><span class="nf">nil?</span> <span class="o">||</span> <span class="n">browser</span><span class="p">.</span><span class="nf">empty?</span>
    <span class="nb">puts</span> <span class="n">uri</span>
  <span class="k">else</span>
    <span class="nb">system</span><span class="p">(</span><span class="n">browser</span><span class="p">,</span> <span class="n">uri</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure>

<p>If the <code class="language-plaintext highlighter-rouge">BROWSER</code> environment variable is set, the command uses it to open your browser with the link. Else, it juts prints the URI. Pretty easy, right?</p>

<p><img loading="lazy" style="display: block; margin: 0 auto;" src="/assets/img/goddamn-right.gif" /></p>

<h2 id="the-end"><a href="#the-end">The End</a></h2>
<p>Well, that‚Äôs it! I told you that it wasn‚Äôt hard at all. This was one of the last posts I‚Äôll do about my work on GSoC, since it‚Äôs getting to the end. In the next update I‚Äôll talk about the <a href="/lessons-learned-on-gsoc-2019/">lessons I‚Äôve learned</a> while contributing for Rubygems. ‚ÄòTill next time, folks!</p>




  <div class="Categories">
    <h2>Categories</h2>

    
    
      <a href="/categories/#cli"><span class="Tag Tag--outlined">cli</span></a>
    
      <a href="/categories/#gsoc"><span class="Tag Tag--outlined">gsoc</span></a>
    
      <a href="/categories/#ruby"><span class="Tag Tag--outlined">ruby</span></a>
    
      <a href="/categories/#rubygems"><span class="Tag Tag--outlined">rubygems</span></a>
    
  </div>

  <!-- POST NAVIGATION -->
  <div class="postNav clearfix">
    
      <a class="prev" href="/how-rubygems-commands-work/"><span>&laquo;&nbsp;How Rubygems commands works</span>
      
    </a>
    
    
      <a class="next" href="/lessons-learned-on-gsoc-2019/"><span>Lessons Learned on GSoC 2019&nbsp;&raquo;</span>
      
      </a>
    
  </div>
</article>
      </div>
   </div><!-- end .content -->

   <div class="footer">
   <div class="container">
      <p class="copy"></a> Powered by <a href="http://jekyllrb.com">Jekyll</a> ‚ù§Ô∏è</p>

      <div class="footer-links">
         <ul class="noList">
            
            
            <li><a href="https://twitter.com/matheusrich">
                  <svg id="twitter" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 100" style="height: 30px; width: 30px;"><circle class="outer-shape" cx="50" cy="50" r="48" style="opacity: 1;"></circle>
                  <path class="inner-shape" style="opacity: 1;" transform="translate(25,25) scale(0.5)" d="M99.001,19.428c-3.606,1.608-7.48,2.695-11.547,3.184c4.15-2.503,7.338-6.466,8.841-11.189 c-3.885,2.318-8.187,4-12.768,4.908c-3.667-3.931-8.893-6.387-14.676-6.387c-11.104,0-20.107,9.054-20.107,20.223 c0,1.585,0.177,3.128,0.52,4.609c-16.71-0.845-31.525-8.895-41.442-21.131C6.092,16.633,5.1,20.107,5.1,23.813 c0,7.017,3.55,13.208,8.945,16.834c-3.296-0.104-6.397-1.014-9.106-2.529c-0.002,0.085-0.002,0.17-0.002,0.255 c0,9.799,6.931,17.972,16.129,19.831c-1.688,0.463-3.463,0.71-5.297,0.71c-1.296,0-2.555-0.127-3.783-0.363 c2.559,8.034,9.984,13.882,18.782,14.045c-6.881,5.424-15.551,8.657-24.971,8.657c-1.623,0-3.223-0.096-4.796-0.282 c8.898,5.738,19.467,9.087,30.82,9.087c36.982,0,57.206-30.817,57.206-57.543c0-0.877-0.02-1.748-0.059-2.617 C92.896,27.045,96.305,23.482,99.001,19.428z"></path>
                  </svg>
            </a></li>
            
            
            <li><a href="https://github.com/matheusrich">
                  <svg id="github" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 100" style="height: 30px; width: 30px;"><circle class="outer-shape" cx="50" cy="50" r="48" style="opacity: 1;"></circle>
                  <path class="inner-shape" style="opacity: 1;" transform="translate(25,25) scale(0.5)" d="M50,1C22.938,1,1,22.938,1,50s21.938,49,49,49s49-21.938,49-49S77.062,1,50,1z M79.099,79.099 c-3.782,3.782-8.184,6.75-13.083,8.823c-1.245,0.526-2.509,0.989-3.79,1.387v-7.344c0-3.86-1.324-6.699-3.972-8.517 c1.659-0.16,3.182-0.383,4.57-0.67c1.388-0.287,2.855-0.702,4.402-1.245c1.547-0.543,2.935-1.189,4.163-1.938 c1.228-0.75,2.409-1.723,3.541-2.919s2.082-2.552,2.847-4.067s1.372-3.334,1.818-5.455c0.446-2.121,0.67-4.458,0.67-7.01 c0-4.945-1.611-9.155-4.833-12.633c1.467-3.828,1.308-7.991-0.478-12.489l-1.197-0.143c-0.829-0.096-2.321,0.255-4.474,1.053 c-2.153,0.798-4.57,2.105-7.249,3.924c-3.797-1.053-7.736-1.579-11.82-1.579c-4.115,0-8.039,0.526-11.772,1.579 c-1.69-1.149-3.294-2.097-4.809-2.847c-1.515-0.75-2.727-1.26-3.637-1.532c-0.909-0.271-1.754-0.439-2.536-0.503 c-0.782-0.064-1.284-0.079-1.507-0.048c-0.223,0.031-0.383,0.064-0.478,0.096c-1.787,4.53-1.946,8.694-0.478,12.489 c-3.222,3.477-4.833,7.688-4.833,12.633c0,2.552,0.223,4.889,0.67,7.01c0.447,2.121,1.053,3.94,1.818,5.455 c0.765,1.515,1.715,2.871,2.847,4.067s2.313,2.169,3.541,2.919c1.228,0.751,2.616,1.396,4.163,1.938 c1.547,0.543,3.014,0.957,4.402,1.245c1.388,0.287,2.911,0.511,4.57,0.67c-2.616,1.787-3.924,4.626-3.924,8.517v7.487 c-1.445-0.43-2.869-0.938-4.268-1.53c-4.899-2.073-9.301-5.041-13.083-8.823c-3.782-3.782-6.75-8.184-8.823-13.083 C9.934,60.948,8.847,55.56,8.847,50s1.087-10.948,3.231-16.016c2.073-4.899,5.041-9.301,8.823-13.083s8.184-6.75,13.083-8.823 C39.052,9.934,44.44,8.847,50,8.847s10.948,1.087,16.016,3.231c4.9,2.073,9.301,5.041,13.083,8.823 c3.782,3.782,6.75,8.184,8.823,13.083c2.143,5.069,3.23,10.457,3.23,16.016s-1.087,10.948-3.231,16.016 C85.848,70.915,82.88,75.317,79.099,79.099L79.099,79.099z"></path>
                  </svg>
            </a></li>
            
            
            <li><a href="https://www.linkedin.com/in/matheus-richard">
                  <svg id="linkedin" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 100" style="height: 30px; width: 30px;"><circle class="outer-shape" cx="50" cy="50" r="48" style="opacity: 1;"></circle>
                  <path class="inner-shape" style="opacity: 1;" transform="translate(30,25) scale(1.8)" d="M4.98 3.5c0 1.381-1.11 2.5-2.48 2.5s-2.48-1.119-2.48-2.5c0-1.38 1.11-2.5 2.48-2.5s2.48 1.12 2.48 2.5zm.02 4.5h-5v16h5v-16zm7.982 0h-4.968v16h4.969v-8.399c0-4.67 6.029-5.052 6.029 0v8.399h4.988v-10.131c0-7.88-8.922-7.593-11.018-3.714v-2.155z"/>
                  </svg>
            </a></li>
            
            <li>
               <a href="https://dev.to/matheusrich" class="dark-safe">
                 <img src="/assets/img/dev-to-badge.svg" alt="Matheus Richard's DEV Profile" height="30" width="30">
               </a>
            </li>
            
            <li><a href="mailto:matheusrichardt@gmail.com">
                  <svg id="mail" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 100" style="height: 30px; width: 30px;"><circle class="outer-shape" cx="50" cy="50" r="48" style="opacity: 1;"></circle>
                  <path class="inner-shape" style="opacity: 1;" transform="translate(25,25) scale(0.5)" d="M50,1C22.938,1,1,22.938,1,50s21.938,49,49,49s49-21.938,49-49S77.062,1,50,1z M25.5,25.5h49 c0.874,0,1.723,0.188,2.502,0.542L50,57.544L22.998,26.041C23.777,25.687,24.626,25.499,25.5,25.5L25.5,25.5z M19.375,68.375v-36.75 c0-0.128,0.005-0.256,0.014-0.383l17.96,20.953L19.587,69.958C19.448,69.447,19.376,68.916,19.375,68.375L19.375,68.375z M74.5,74.5 h-49c-0.541,0-1.072-0.073-1.583-0.212l17.429-17.429L50,66.956l8.653-10.096l17.429,17.429C75.572,74.427,75.041,74.5,74.5,74.5 L74.5,74.5z M80.625,68.375c0,0.541-0.073,1.072-0.211,1.583L62.652,52.195l17.96-20.953c0.008,0.127,0.014,0.255,0.014,0.383 L80.625,68.375L80.625,68.375z"></path>
                  </svg>
            </a></li>
            
         </ul>
      </div>
   </div>
</div><!-- end .footer -->


   <script defer src="/assets/js/responsive-nav.min.js"></script>
<script defer type="module" src="/assets/js/scripts.js"></script>


</body>

</html>
